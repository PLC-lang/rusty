(* ****************************************************************************
 * Copyright (c) 2025 Bachmann electronic GmbH *
 **************************************************************************** *)
(**
 * @addtogroup VPoolPvAsyncETrig Edge triggered vpool function blocks
 * @brief Edge triggered file function blocks according to the PLCopen specification.
 *
 * These function blocks implement a wrapper over the synchronous vpool interface.
 * The function blocks behave like the edge triggered function blocks described by the PLCopen specification.
 * @{
*)
(**
 * @brief Open a process variable asynchronously (async edge triggered).
 *
 * This function block is edge triggered and extends ETrig base class.
 *
 * @param[in] Name Process variable name.
 * @param[in] Flags Open flags.
 * @param[out] PvHandle Process variable handle.
 * @see VPOOL_Pv_Open, VPOOL_CloseAsync
 *)
FUNCTION_BLOCK VPOOL_OpenAsync EXTENDS ETrig
VAR_INPUT
    Name: STRING[VPOOL_PATH_NAME_LEN-1];
    Flags: VPOOL_Flags := VPOOL_Flags_ReadOnly;
END_VAR
VAR_OUTPUT
    PvHandle: VPOOL_Handle;
END_VAR
VAR
    PvAsync: VPOOL_PvAsync;
    OpenParams: VPOOL_OpenParams;
    JobState: ASYNC_JobState;
END_VAR
METHOD StartAction: ErrorCode
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
METHOD CyclicAction: ErrorCode
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
METHOD ResetAction
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
END_FUNCTION_BLOCK
(**
 * @brief Close a process variable (async edge triggered)
 *
 * This function block is edge triggered and extends ETrig base class.
 *
 * @param[in] PvHandle Process variable handle.
 * @see VPOOL_Pv_Close, VPOOL_OpenAsync
 *)
FUNCTION_BLOCK VPOOL_CloseAsync EXTENDS ETrig
VAR_INPUT
    PvHandle: VPOOL_Handle;
END_VAR
VAR
    PvAsync: VPOOL_PvAsync;
    CloseParams: VPOOL_CloseParams;
    JobState: ASYNC_JobState;
END_VAR
METHOD StartAction: ErrorCode
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
METHOD CyclicAction: ErrorCode
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
METHOD ResetAction
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
END_FUNCTION_BLOCK
(** @} **)
