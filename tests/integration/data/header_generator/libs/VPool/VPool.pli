(*****************************************************************************
 * Copyright (c) 2025 Bachmann electronic GmbH                               *
 *****************************************************************************)
 (**
 * @addtogroup VPoolPv
 * @brief Functions and function blocks to interact with process variables.
 * @{
*)
(**
 * @brief Open process variable for access via shared memory.
 *
 * @note This function is blocking and may not be used by high priority tasks directly since it may cause cycle time violations.
 *
 * @param[in] Name The full variable name (e.g. "MyApp.MyVar")
 * @param[in] Flags Open flags
 * @param[out] Error Error code
 * @return Process variable handle.
 * @see VPOOL_Pv_Close()
 *)
FUNCTION VPOOL_Pv_Open: VPOOL_Handle
VAR_INPUT
    Name : STRING[VPOOL_PATH_NAME_LEN-1];
    Flags : VPOOL_Flags := VPOOL_Flags_ReadOnly;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Close process variable.
 *
 * @note This function is blocking and may not be used by high priority tasks directly since it may cause cycle time violations.
 *
 * @param[in] PvHandle PV handle
 * @return Error code
 * @see VPOOL_Pv_Open
 *)
Function VPOOL_Pv_Close: ErrorCode
VAR_INPUT
    PvHandle: VPOOL_Handle;
END_VAR
END_FUNCTION
(**
 * @brief Determines if process variable is opened and valid.
 *
 * @param[in] pv PV handle
 * @return @c true if variable is valid, @c false otherwise
 *)
FUNCTION VPOOL_Pv_IsValid: BOOL
VAR_INPUT
    PvHandle: VPOOL_Handle;
END_VAR
END_FUNCTION
(**
 * @brief Get the variable name from a process variable handle.
 *
 * @param[in] PvHandle PV handle
 * @param[out] Error Error code
 * @return Variable name.
 * @see VPOOL_Pv_Open
 *)
FUNCTION VPOOL_Pv_GetName: STRING[VPOOL_PATH_NAME_LEN-1]
VAR_INPUT
    PvHandle: VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read raw value of process variable.
 *
 * Generic read function to read any type of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[inout] Data Pointer to the data
 * @param[inout] Size Data length. The length must match the data size of the process variable.
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Read : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Data : POINTER TO BYTE;
    Size : DINT;
END_VAR
END_FUNCTION
(**
 * @brief Read a boolean value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return Boolean value
 *)
FUNCTION VPOOL_Pv_Read_BOOL: BOOL
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a SINT value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return SINT value
 *)
FUNCTION VPOOL_Pv_Read_SINT: SINT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a USINT value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return USINT value
 *)
FUNCTION VPOOL_Pv_Read_USINT: USINT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a BYTE value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return BYTE value
 *)
FUNCTION VPOOL_Pv_Read_BYTE: BYTE
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read an INT value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return INT value
 *)
FUNCTION VPOOL_Pv_Read_INT: INT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a UINT value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return UINT value
 *)
FUNCTION VPOOL_Pv_Read_UINT: UINT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a WORD value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return WORD value
 *)
FUNCTION VPOOL_Pv_Read_WORD: WORD
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a DINT value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return DINT value
 *)
FUNCTION VPOOL_Pv_Read_DINT: DINT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a UDINT value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return UDINT value
 *)
FUNCTION VPOOL_Pv_Read_UDINT: UDINT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a DWORD value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return DWORD value
 *)
FUNCTION VPOOL_Pv_Read_DWORD: DWORD
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a LINT value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return LINT value
 *)
FUNCTION VPOOL_Pv_Read_LINT: LINT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a ULINT value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return ULINT value
 *)
FUNCTION VPOOL_Pv_Read_ULINT: ULINT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a REAL value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return REAL value
 *)
FUNCTION VPOOL_Pv_Read_REAL: REAL
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a LREAL value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return LREAL value
 *)
FUNCTION VPOOL_Pv_Read_LREAL: LREAL
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a date and time value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return DT value
 *)
FUNCTION VPOOL_Pv_Read_DT: DT
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a CHAR value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return CHAR value
 *)
FUNCTION VPOOL_Pv_Read_CHAR: CHAR
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Read a STRING value up to 255 characters of a process variable.
 *
 * @note The defined string in PLC must be one character shorter than the actual string type in the vpool.
 *        VPool size: 16 bytes
 *        Definition: `MyString: STRING[15];`
 *        Example call: `MyString := VPOOL_Pv_Read_STRING(PvHandle, SIZEOF(MyString), Error);`
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Length The length of the PV to be read (must match)
 * @param[out] Error Error code
 * @return STRING value (max 255 chars)
 *)
FUNCTION VPOOL_Pv_Read_STRING: STRING[255]
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Length : USINT;
END_VAR
VAR_OUTPUT
    Error : ErrorCode;
END_VAR
END_FUNCTION
(**
 * @brief Write the raw value of a process variable.
 *
 * Generic write function to write any type of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Data Pointer to the data
 * @param[in] Size Data length. The length must match the data size of the process variable.
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Data : POINTER TO BYTE;
    Size : DINT;
END_VAR
END_FUNCTION
(**
 * @brief Write a boolean value of a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value Boolean value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_BOOL : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : BOOL;
END_VAR
END_FUNCTION
 (**
 * @brief Write a SINT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value SINT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_SINT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : SINT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a USINT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value USINT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_USINT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : USINT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a BYTE value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value BYTE value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_BYTE : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : BYTE;
END_VAR
END_FUNCTION
 (**
 * @brief Write an INT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value INT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_INT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : INT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a UINT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value UINT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_UINT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : UINT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a WORD value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value WORD value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_WORD : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : WORD;
END_VAR
END_FUNCTION
 (**
 * @brief Write a DINT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value DINT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_DINT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : DINT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a UDINT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value UDINT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_UDINT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : UDINT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a DWORD value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value DWORD value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_DWORD : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : DWORD;
END_VAR
END_FUNCTION
 (**
 * @brief Write a LINT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value LINT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_LINT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : LINT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a ULINT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value ULINT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_ULINT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : ULINT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a REAL value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value REAL value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_REAL : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : REAL;
END_VAR
END_FUNCTION
 (**
 * @brief Write a LREAL value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value LREAL value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_LREAL : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : LREAL;
END_VAR
END_FUNCTION
 (**
 * @brief Write a DT value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value DT value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_DT : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : DT;
END_VAR
END_FUNCTION
 (**
 * @brief Write a CHAR value to a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value CHAR value
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_CHAR : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : CHAR;
END_VAR
END_FUNCTION
 (**
 * @brief Write a STRING value to a process variable (max 255 chars).
 *
 * @note The defined string in PLC must be one character shorter than the actual string type in the vpool.
 *        VPool size: 16 bytes
 *        Definition: `MyString: STRING[15];`
 *        Example call: `Error := VPOOL_Pv_Write_STRING(PvHandle, MyString, SIZEOF(MyString));`
 *
 * @param[in] PvHandle Pv handle
 * @param[in] Value STRING value (max 255 chars)
 * @param[in] Length Length of the destination process variable
 * @return Error code
 *)
FUNCTION VPOOL_Pv_Write_STRING : ErrorCode
VAR_INPUT
    PvHandle : VPOOL_Handle;
    Value : STRING[255];
    Length : USINT;
END_VAR
END_FUNCTION
 (**
 * @brief Get the attributes from a process variable.
 *
 * @param[in] PvHandle Pv handle
 * @param[out] Error Error code
 * @return Process variable attributes.
 *)
FUNCTION VPOOL_Pv_GetAttributes : VPOOL_Attributes
VAR_INPUT
    PvHandle : VPOOL_Handle;
END_VAR
VAR_OUTPUT
    Error: ErrorCode;
END_VAR
END_FUNCTION
(**
 * @}
*)
