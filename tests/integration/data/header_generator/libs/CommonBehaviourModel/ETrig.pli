(* ****************************************************************************
 * Copyright (c) 2025 Bachmann electronic GmbH *
 **************************************************************************** *)
FUNCTION_BLOCK ETrig
VAR_INPUT
    Execute: BOOL; (* *< Start operation on rising edge *)
END_VAR
VAR_OUTPUT
    Done: BOOL; (* *< Operation completed successfully *)
    Busy: BOOL; (* *< Operation in progress *)
    Error: BOOL; (* *< Operation failed *)
    ErrorID: ErrorCode; (* *< Error code *) // TODO(MAKO): use error code or just a DINT?
END_VAR
VAR
    State: CBMState := CBMState_Dormant;
END_VAR
METHOD StartAction: ErrorCode
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
METHOD CyclicAction: ErrorCode
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
METHOD ResetAction
VAR_OUTPUT
    Complete: BOOL;
END_VAR
END_METHOD
METHOD PRIVATE HandleDormantState
VAR_OUTPUT
    Again: BOOL;
END_VAR
VAR
    Complete: BOOL;
END_VAR
END_METHOD
METHOD PRIVATE HandleExecutingState
VAR_OUTPUT
    Again: BOOL;
END_VAR
VAR
    Complete: BOOL;
END_VAR
END_METHOD
METHOD PRIVATE HandleDoneState
VAR_OUTPUT
    Again: BOOL;
END_VAR
END_METHOD
METHOD PRIVATE HandleErrorState
VAR_OUTPUT
    Again: BOOL;
END_VAR
END_METHOD
METHOD PRIVATE HandleResettingState
VAR_OUTPUT
    Again: BOOL;
END_VAR
VAR
    Complete: BOOL;
END_VAR
END_METHOD
END_FUNCTION_BLOCK
